# セーリング戦略分析システム - ユーザーガイド

## 目次

1. [はじめに](#はじめに)
2. [システム要件](#システム要件)
3. [インストールと起動](#インストールと起動)
4. [基本的な使い方](#基本的な使い方)
   - [プロジェクト管理](#プロジェクト管理)
   - [データのインポート](#データのインポート)
   - [データの検証と修正](#データの検証と修正)
   - [分析と可視化](#分析と可視化)
   - [結果のエクスポート](#結果のエクスポート)
5. [トラブルシューティング](#トラブルシューティング)
6. [よくある質問](#よくある質問)

## はじめに

セーリング戦略分析システムは、セーリング競技者とコーチのためのデータ分析ツールです。GPSデータから風向風速を推定し、戦略的判断ポイントを検出して、パフォーマンスを客観的に評価することができます。

本システムの主な機能：

- GPSデータのインポートと前処理
- 風向風速の推定
- 戦略判断ポイントの検出
- データの可視化と分析
- 結果のエクスポート

## システム要件

- **オペレーティングシステム**: Windows 10/11, macOS 10.15+, Linux
- **メモリ**: 4GB以上推奨
- **ディスク容量**: 200MB以上の空き容量
- **ブラウザ**: Google Chrome, Mozilla Firefox, Microsoft Edge (最新版推奨)
- **インターネット接続**: 基本機能には不要、更新とマップ表示に必要

## インストールと起動

### ローカルでの実行

1. リポジトリをクローンまたはダウンロード
   ```
   git clone https://github.com/your-username/sailing-strategy-analyzer.git
   ```

2. 依存パッケージのインストール
   ```
   cd sailing-strategy-analyzer
   pip install -r requirements.txt
   ```

3. アプリケーションの起動
   - Windowsの場合: `run_app.bat` をダブルクリック
   - Mac/Linuxの場合: ターミナルで `./run_app.sh` を実行

4. ブラウザが自動的に開き、アプリケーションが表示されます。表示されない場合は、ブラウザで `http://localhost:8501` にアクセスしてください。

### Streamlit Cloudでの実行

Streamlit Cloudでホストされているバージョンにアクセスする場合は、以下のURLにアクセスしてください：
```
https://sailing-strategy-analyzer.streamlit.app
```

## 基本的な使い方

### プロジェクト管理

アプリケーションはプロジェクトベースで構成されています。一つのプロジェクトに複数のセーリングセッションを含めることができます。

#### 新規プロジェクトの作成

1. サイドバーから「プロジェクト管理」を選択
2. 「新規プロジェクト」ボタンをクリック
3. プロジェクト名、説明、タグなどの情報を入力
4. 「作成」ボタンをクリック

#### プロジェクトの操作

- **編集**: プロジェクト一覧から対象プロジェクトの「編集」ボタンをクリック
- **削除**: 「削除」ボタンをクリックし、確認ダイアログで承認
- **詳細表示**: プロジェクト名をクリックすると詳細ページに移動

### データのインポート

サポートされているデータ形式：
- CSV ファイル
- GPX ファイル
- FIT ファイル (Garminデバイス)

#### データインポートの手順

1. プロジェクト詳細ページで「新規セッション」を作成
2. 「データインポート」タブを選択
3. 「ファイルをアップロード」ボタンでファイルを選択
4. データのプレビューを確認
5. 列のマッピングを設定（CSVの場合）
6. 「インポート実行」ボタンをクリック

### データの検証と修正

インポートされたデータは自動的に検証され、問題がある場合は「データ検証」ページで表示されます。

#### 一般的な問題と修正

- **欠損値**: 「補間」または「削除」を選択
- **外れ値**: しきい値を調整して「修正」ボタンをクリック
- **GPS異常**: マップ上で異常値を確認し、「修正」または「削除」を選択

### 分析と可視化

#### 風推定

1. セッション詳細ページで「風推定」タブを選択
2. 推定パラメータを設定
3. 「推定実行」ボタンをクリック
4. 結果がマップと図表で表示されます

#### 戦略検出

1. 「戦略分析」タブを選択
2. 検出パラメータを設定
3. 「検出実行」ボタンをクリック
4. 戦略的判断ポイントがマップ上にマーカーで表示されます

#### データの可視化

- **マップビュー**: GPSトラック、風向風速、戦略ポイントを表示
- **チャートビュー**: 速度、方向、風向風速などのグラフ表示
- **統計ビュー**: セッションの主要統計データの表示

### 結果のエクスポート

分析結果は以下の形式でエクスポートできます：

- CSV ファイル
- JSONファイル
- マップイメージ (PNG, PDF)
- レポート (PDF)

#### エクスポート手順

1. 「エクスポート」タブを選択
2. エクスポート形式と内容を選択
3. 「エクスポート実行」ボタンをクリック
4. ファイルがダウンロードされます

## トラブルシューティング

### 一般的な問題

1. **アプリケーションが起動しない**
   - Pythonとすべての依存パッケージが正しくインストールされていることを確認
   - コンソールのエラーメッセージを確認

2. **ファイルがインポートできない**
   - ファイル形式が正しいことを確認
   - ファイルが破損していないことを確認
   - 列名マッピングが正しく設定されていることを確認

3. **風推定結果が不正確**
   - GPS精度を確認
   - より高い頻度のデータポイントを使用
   - パラメータを調整

4. **分析処理が遅い**
   - 大きなデータセットの場合は、データポイントのサンプリングを検討
   - 不要な列を削除してデータサイズを小さくする

## よくある質問

### Q: どのようなデータ形式がサポートされていますか？
A: 現在、CSV、GPX、FITファイル形式をサポートしています。CSVファイルの場合、タイムスタンプ、緯度、経度、速度、方向などの列が必要です。

### Q: オフラインでも使用できますか？
A: はい、一度ダウンロードすれば、基本的な機能はインターネット接続なしで使用できます。ただし、ベースマップの表示には接続が必要な場合があります。

### Q: データはどこに保存されますか？
A: ローカル実行の場合、すべてのデータはローカルコンピュータに保存されます。Streamlit Cloudバージョンでは、セッション中のみブラウザに保存され、必要に応じてエクスポートする必要があります。

### Q: 複数のセッションを比較できますか？
A: はい、「比較」機能を使用して複数のセッションを選択し、パフォーマンスや戦略を比較できます。

### Q: データはどのくらいの頻度で収集すべきですか？
A: 風推定の精度を上げるためには、少なくとも5秒ごとのデータポイントが推奨されます。より頻繁なデータ収集（1-2秒ごと）でより正確な結果が得られます。
